
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Flatland Environment</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/flatland-logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../book/intro.html">
   Welcome to Flatland
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../book/getting-started/installation.html">
   Installing Flatland
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/getting-started/env.html">
   Flatland Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/getting-started/The_Rail_Environment.html">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     RailEnv
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/getting-started/sequential-agent.html">
   Sequential Agent
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../book/env/observations.html">
   Provided Observations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/env/level_generation.html">
   Level Generation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/env/environment_information.html">
   Environment information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/env/custom_observations.html">
   Custom observations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/env/speed_profiles.html">
   Speed profiles
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../book/env/updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/env/updates/Agent-Close-Following.html">
     Unordered Close Following
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://flatlandrl-docs.aicrowd.com/flatland.html">
   API Reference
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../book/tuts/or.html">
   Operations Research
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../book/tuts/rl.html">
   Reinforcement Learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/tuts/rl/single-agent.html">
     Single agent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/tuts/rl/multi-agent.html">
     Multiple Agents
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Challenges
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../book/challenges/amld2021.html">
   AMLD 2021
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/challenges/amld2021/envconfig.html">
     Environment Configurations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/challenges/amld2021/eval.html">
     Evaluation Metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/challenges/amld2021/first-submission.html">
     Making a Submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../book/challenges/neurips2020-challenge.html">
   Neurips 2020
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/challenges/neurips2020/envconfig.html">
     Environment Configurations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/challenges/neurips2020/eval.html">
     Evaluation Metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/challenges/neurips2020/first-submission.html">
     Making a Submission
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/challenges/neurips2020/faq.html">
     FAQs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/challenges/halloffame.html">
   Hall of Fame
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Research
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../book/research/baselines.html">
   RLlib Baselines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/research/baselines/getting-started.html">
     Getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/research/baselines/centralized_critic.html">
     Centralized Critic PPO
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/research/baselines/imitation_learning.html">
     Imitation Learning Training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/research/baselines/global_density_obs.html">
     Global Density Observation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/research/baselines/combined_tree_local_conflict_obs.html">
     Combined Observation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/research/baselines/action_masking_and_skipping.html">
     Frame skipping and action masking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/research/research-ideas.html">
   Research Ideas
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  FAQ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../book/faq/env.html">
   Flatland Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/faq/research.html">
   Flatland Research
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../book/misc/external-resources.html">
   Community Projects
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../book/misc/contributing.html">
   Contributing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/misc/contributing-code.html">
     Writing code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../book/misc/contributing-doc.html">
     Writing documentation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../book/misc/credits.html">
   Credits
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/faq/env.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-can-i-get-started-with-flatland">
   How can I get started with Flatland?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-do-i-train-agents-on-flatland">
   How do I train agents on Flatland?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-an-observation-builder">
   What is an observation builder?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-predictor">
   What is a predictor?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-information-is-available-about-agents">
   What information is available about agents?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#can-i-use-my-own-reward-function">
   Can I use my own reward function?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-are-rail-and-schedule-generators">
   What are rail and schedule generators?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-the-max-number-of-timesteps-per-episode">
   What is the max number of timesteps per episode?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-are-malfunctions-and-what-can-i-do-to-resolve-them">
   What are malfunctions and what can i do to resolve them?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#can-agents-communication-with-each-other">
   Can agents communication with each other?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-are-my-trains-drawn-outside-of-the-rails">
   Why are my trains drawn outside of the rails?
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="flatland-environment">
<h1>Flatland Environment<a class="headerlink" href="#flatland-environment" title="Permalink to this headline">¶</a></h1>
<p>This section provides you with information about the most common questions about the Flatland environment itself. If your question is still not answered either reach out to the contacts listed on the repository directly or open an issue by following these <a class="reference internal" href="../misc/contributing.html"><span class="doc std std-doc">guidelines</span></a>.</p>
<div class="section" id="how-can-i-get-started-with-flatland">
<h2>How can I get started with Flatland?<a class="headerlink" href="#how-can-i-get-started-with-flatland" title="Permalink to this headline">¶</a></h2>
<p>Install Flatland by running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-U</span> <span class="pre">flatland-rl</span></code> or directly from source by cloning the flatland repository and running <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">--install</span></code> in the repository directory.</p>
<p>The <a class="reference external" href="https://gitlab.aicrowd.com/flatland/flatland/blob/master/README.md#-setup">README</a> file in the Flatland repository provides more details. <a class="reference internal" href="../getting-started/first-submission.html"><span class="doc std std-doc">Read the this guide</span></a> to learn how to make your first submission.</p>
</div>
<div class="section" id="how-do-i-train-agents-on-flatland">
<h2>How do I train agents on Flatland?<a class="headerlink" href="#how-do-i-train-agents-on-flatland" title="Permalink to this headline">¶</a></h2>
<p>Once you have installed Flatland, head over to the <a class="reference external" href="https://gitlab.aicrowd.com/flatland/flatland-examples">examples repository</a> to see how you can train your own reinforcement learning agent on Flatland.</p>
<p>Check out this <a class="reference internal" href="../getting-started/rl.html"><span class="doc std std-doc">tutorial</span></a> to get a sense of how it works.</p>
</div>
<div class="section" id="what-is-an-observation-builder">
<h2>What is an observation builder?<a class="headerlink" href="#what-is-an-observation-builder" title="Permalink to this headline">¶</a></h2>
<p>Observation builders give you the possibility to generate custom observations for your controller (reinforcement learning agent, optimization algorithms, …). The observation builder has access to all environment data and can perform any operations on them as long as they don’t change the environment’s state.</p>
<p>This <a class="reference internal" href="../getting-started/env/custom_observations.html"><span class="doc std std-doc">tutorial</span></a> will give you a sense on how to use them.</p>
</div>
<div class="section" id="what-is-a-predictor">
<h2>What is a predictor?<a class="headerlink" href="#what-is-a-predictor" title="Permalink to this headline">¶</a></h2>
<p>Because railway traffic is limited to rails, many decisions that you have to take need to consider future situations and detect upcoming conflicts ahead of time. Therefore, flatland provides the possibility of predictors that predict where agents will be in the future. We provide a stock predictor that assumes each agent just travels along its shortest path.</p>
<p>You can build more elaborate predictors and use them as part of your observation builder. You can find <a class="reference internal" href="../getting-started/env/custom_observations.html"><span class="doc std std-doc">more information here</span></a>.</p>
</div>
<div class="section" id="what-information-is-available-about-agents">
<h2>What information is available about agents?<a class="headerlink" href="#what-information-is-available-about-agents" title="Permalink to this headline">¶</a></h2>
<p>Each agent is an object and contains the following information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">initial_position</span> <span class="pre">=</span> <span class="pre">attrib(type=Tuple[int,</span> <span class="pre">int])</span></code>: The initial position of an agent. This is where the agent will enter the environment. It is the start of the agent journey.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">=</span> <span class="pre">attrib(default=None,</span> <span class="pre">type=Optional[Tuple[int,</span> <span class="pre">int]])</span></code>: This is the actual position of the agent. It is updated every step of the environment. Before the agent has entered the environment and after it leaves the environment it is set to <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction</span> <span class="pre">=</span> <span class="pre">attrib(type=Grid4TransitionsEnum)</span></code>: This is the direction an agent is facing. The values for directions are <code class="docutils literal notranslate"><span class="pre">North:0</span></code>, <code class="docutils literal notranslate"><span class="pre">East:1</span></code>, <code class="docutils literal notranslate"><span class="pre">South:2</span></code> and <code class="docutils literal notranslate"><span class="pre">West:3</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target</span> <span class="pre">=</span> <span class="pre">attrib(type=Tuple[int,</span> <span class="pre">int])</span></code>: This is the target position the agent has to find and reach. Once the agent reaches this position its taks is done.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">moving</span> <span class="pre">=</span> <span class="pre">attrib(default=False,</span> <span class="pre">type=bool)</span></code>: Because agents can have malfunctions or be stopped because their path is blocked we store the current state of an agent. If <code class="docutils literal notranslate"><span class="pre">agent.moving</span> <span class="pre">==</span> <span class="pre">True</span></code> the agent is currently advancing. If it is <code class="docutils literal notranslate"><span class="pre">False</span></code> the agent is either blocked or broken.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">speed_data</span> <span class="pre">=</span> <span class="pre">attrib(default=Factory(lambda:</span> <span class="pre">dict({'position_fraction':</span> <span class="pre">0.0,</span> <span class="pre">'speed':</span> <span class="pre">1.0,</span> <span class="pre">'transition_action_on_cellexit':</span> <span class="pre">0})))</span></code>: This contains all the relevant information about the speed of an agent:</p>
<ul>
<li><p>The attribute <code class="docutils literal notranslate"><span class="pre">'position_fraction'</span></code> indicates how far the agent has advanced within the cell. As soon as this value becomes larger than <code class="docutils literal notranslate"><span class="pre">1</span></code> the agent advances to the next cell as defined by <code class="docutils literal notranslate"><span class="pre">'transition_action_on_cellexit'</span></code>.</p></li>
<li><p>The attribute <code class="docutils literal notranslate"><span class="pre">'speed''</span></code> defines the travel speed of an agent. It can be any fraction smaller than 1.</p></li>
<li><p>The attribute <code class="docutils literal notranslate"><span class="pre">'transition_action_on_cellexit'</span></code> contains the information about the action that will be performed at the exit of the cell. Due to speeds smaller than 1. agents have to take several steps within a cell. We however only allow an action to be chosen at cell entry.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">malfunction_data</span> <span class="pre">=</span> <span class="pre">attrib(default=Factory(lambda:</span> <span class="pre">dict({'malfunction':</span> <span class="pre">0,</span> <span class="pre">'malfunction_rate':</span> <span class="pre">0,</span> <span class="pre">'next_malfunction':</span> <span class="pre">0,</span> <span class="pre">'nr_malfunctions':</span> <span class="pre">0,'moving_before_malfunction':</span> <span class="pre">False})))</span></code>: Contains all information relevant for agent malfunctions:</p>
<ul>
<li><p>The attribute <code class="docutils literal notranslate"><span class="pre">'malfunction</span></code> indicates if the agent is currently broken. If the value is larger than <code class="docutils literal notranslate"><span class="pre">0</span></code> the agent is broken. The integer value represents the number of <code class="docutils literal notranslate"><span class="pre">env.step()</span></code> calls the agent will still be broken.</p></li>
<li><p>The attribute <code class="docutils literal notranslate"><span class="pre">'next_malfunction'</span></code> will be REMOVED as it serves no purpose anymore, malfunctions are now generated by a poisson process.</p></li>
<li><p>The attribute <code class="docutils literal notranslate"><span class="pre">'nr_malfunctions'</span></code> is a counter that keeps track of the number of malfunctions a specific agent has had.</p></li>
<li><p>The attribute <code class="docutils literal notranslate"><span class="pre">'moving_before_malfunction'</span></code> is an internal parameter used to restart agents that were moving automatically after the malfunction is fixed.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span> <span class="pre">=</span> <span class="pre">attrib(default=RailAgentStatus.READY_TO_DEPART,</span> <span class="pre">type=RailAgentStatus)</span></code>: The status of the agent explains what the agent is currently doing. It can be in either one of these states:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">READY_TO_DEPART</span></code> not in grid yet (position is None)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ACTIVE</span></code> in grid (position is not None), not done</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DONE</span></code> in grid (position is not None), but done</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DONE_REMOVED</span></code> removed from grid (position is None)</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="can-i-use-my-own-reward-function">
<h2>Can I use my own reward function?<a class="headerlink" href="#can-i-use-my-own-reward-function" title="Permalink to this headline">¶</a></h2>
<p>Yes you can do reward shaping as you please. Any information can be accessed directly from the env. Of course during the evaluation the <a class="reference internal" href="../getting-started/env.html"><span class="doc std std-doc">official rewards</span></a> will be use to calculate scores!</p>
</div>
<div class="section" id="what-are-rail-and-schedule-generators">
<h2>What are rail and schedule generators?<a class="headerlink" href="#what-are-rail-and-schedule-generators" title="Permalink to this headline">¶</a></h2>
<p>To generate environments for Flatland you need to provide a railway infrastructure (rail) and a set of tasks for each agent to complete (schedule).</p>
</div>
<div class="section" id="what-is-the-max-number-of-timesteps-per-episode">
<h2>What is the max number of timesteps per episode?<a class="headerlink" href="#what-is-the-max-number-of-timesteps-per-episode" title="Permalink to this headline">¶</a></h2>
<p>Since we only use sparse schedule generators for this challenge, the maximum number of timesteps is defined as <code class="docutils literal notranslate"><span class="pre">max_time_steps</span> <span class="pre">=</span> <span class="pre">int(4</span> <span class="pre">*</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">(env.width</span> <span class="pre">+</span> <span class="pre">env.height</span> <span class="pre">+</span> <span class="pre">num_agents</span> <span class="pre">/</span> <span class="pre">num_cities))</span></code>.</p>
<p>See the implementation in <a class="reference external" href="https://gitlab.aicrowd.com/flatland/flatland/blob/master/flatland/envs/schedule_generators.py#L172">envs/schedule_generators.py</a>.</p>
</div>
<div class="section" id="what-are-malfunctions-and-what-can-i-do-to-resolve-them">
<h2>What are malfunctions and what can i do to resolve them?<a class="headerlink" href="#what-are-malfunctions-and-what-can-i-do-to-resolve-them" title="Permalink to this headline">¶</a></h2>
<p>Malfunctions are random events that occur according to a Poisson process. They hinder an agent from performing any action. While an agent is malfunctioning, it is blocking the paths for other agents. There is nothing you can do to fix an agent, it will get fixed automatically as soon as <code class="docutils literal notranslate"><span class="pre">agent.malfunction_data['malfunction']</span> <span class="pre">==</span> <span class="pre">0</span></code>.</p>
<p>You can however adjust the other agent actions to avoid delay propagation within the railway network and keeping traffic as smooth as possible.</p>
</div>
<div class="section" id="can-agents-communication-with-each-other">
<h2>Can agents communication with each other?<a class="headerlink" href="#can-agents-communication-with-each-other" title="Permalink to this headline">¶</a></h2>
<p>There is no communication layer built into Flatland directly. You can however build a communication layer outside of the Flatland environment if necessary.</p>
</div>
<div class="section" id="why-are-my-trains-drawn-outside-of-the-rails">
<h2>Why are my trains drawn outside of the rails?<a class="headerlink" href="#why-are-my-trains-drawn-outside-of-the-rails" title="Permalink to this headline">¶</a></h2>
<p>If you render your environment and the agents appear to be off the rail it is usually due to changes in the railway infrastructure. Make sure that you reset your renderer anytime the infrastructure changes by calling <code class="docutils literal notranslate"><span class="pre">env_renderer.reset()</span></code>.</p>
</div>
</div>


              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Flatland Community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-132885496-4', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>