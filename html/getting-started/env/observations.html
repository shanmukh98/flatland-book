
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Provided Observations</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/custom.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/flatland-logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/intro.html">
   Welcome to Flatland
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/getting-started/installation.html">
   Installing Flatland
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/getting-started/env.html">
   Flatland Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/getting-started/The_Rail_Environment.html">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     RailEnv
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/getting-started/sequential-agent.html">
   Sequential Agent
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/env/observations.html">
   Provided Observations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/env/level_generation.html">
   Level Generation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/env/environment_information.html">
   Environment information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/env/custom_observations.html">
   Custom observations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/env/speed_profiles.html">
   Speed profiles
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../book/env/updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/env/updates/Agent-Close-Following.html">
     Unordered Close Following
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://flatlandrl-docs.aicrowd.com/flatland.html">
   API Reference
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/tuts/or.html">
   Operations Research
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../book/tuts/rl.html">
   Reinforcement Learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/tuts/rl/single-agent.html">
     Single agent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/tuts/rl/multi-agent.html">
     Multiple Agents
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Challenges
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../book/challenges/amld2021.html">
   AMLD 2021
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/challenges/amld2021/envconfig.html">
     Environment Configurations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/challenges/amld2021/eval.html">
     Evaluation Metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/challenges/amld2021/first-submission.html">
     Making a Submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../book/challenges/neurips2020-challenge.html">
   Neurips 2020
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/challenges/neurips2020/envconfig.html">
     Environment Configurations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/challenges/neurips2020/eval.html">
     Evaluation Metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/challenges/neurips2020/first-submission.html">
     Making a Submission
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/challenges/neurips2020/faq.html">
     FAQs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/challenges/halloffame.html">
   Hall of Fame
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Research
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../book/research/baselines.html">
   RLlib Baselines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/research/baselines/getting-started.html">
     Getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/research/baselines/centralized_critic.html">
     Centralized Critic PPO
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/research/baselines/imitation_learning.html">
     Imitation Learning Training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/research/baselines/global_density_obs.html">
     Global Density Observation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/research/baselines/combined_tree_local_conflict_obs.html">
     Combined Observation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/research/baselines/action_masking_and_skipping.html">
     Frame skipping and action masking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/research/research-ideas.html">
   Research Ideas
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  FAQ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/faq/env.html">
   Flatland Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/faq/research.html">
   Flatland Research
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/misc/external-resources.html">
   Community Projects
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../book/misc/contributing.html">
   Contributing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/misc/contributing-code.html">
     Writing code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../book/misc/contributing-doc.html">
     Writing documentation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../book/misc/credits.html">
   Credits
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/getting-started/env/observations.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#global-observation">
   Global observation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#local-grid-observation">
   Local grid observation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tree-observation">
   Tree observation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="provided-observations">
<h1>Provided Observations<a class="headerlink" href="#provided-observations" title="Permalink to this headline">¶</a></h1>
<p>In Flatland, you have full control over the observations that your agents will work with. Three observations are provided as starting point. However, you are encouraged to implement your own.</p>
<p>The three provided observations are:</p>
<ul class="simple">
<li><p><a class="reference external" href="#global-observation">Global observation</a></p></li>
<li><p><a class="reference external" href="#local-grid-observation">Local grid observation</a></p></li>
<li><p><a class="reference external" href="#tree-observation">Tree observation</a></p></li>
</ul>
<p><img alt="stock observations" src="https://i.imgur.com/oo8EIYv.png" /></p>
<p><em><strong>Global, local and tree:</strong> A visual summary of the three provided observations.</em></p>
<div class="section" id="global-observation">
<h2>Global observation<a class="headerlink" href="#global-observation" title="Permalink to this headline">¶</a></h2>
<p>The global observation is the simplest one. In this case, every agent is provided a global view of the full Flatland environment. This can be compared to the full, raw-pixel data used in Atari games. The size of the observation space is <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">×</span> <span class="pre">w</span> <span class="pre">×</span> <span class="pre">c</span></code>, where <code class="docutils literal notranslate"><span class="pre">h</span></code> is the height of the environment, <code class="docutils literal notranslate"><span class="pre">w</span></code> is the width of the environment and <code class="docutils literal notranslate"><span class="pre">c</span></code> is the number of channels of the environment. These channels can be modified by the participants but in the initial configuration, we include the following <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">×</span> <span class="pre">w</span></code> channels:</p>
<ul class="simple">
<li><p><strong>Transition maps:</strong> provides a unique value for each type of transition map and its orientation. Its dimensions is <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">×</span> <span class="pre">w</span> <span class="pre">×</span> <span class="pre">16</span></code> assuming 16 bits encoding of transitions. Transition maps represent the movements allowed on a cell, <a class="reference external" href="custom_observations.html#transitions-maps">read more about them here</a>.</p></li>
<li><p><strong>Agent states:</strong> A 3D array <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">×</span> <span class="pre">w</span> <span class="pre">×</span> <span class="pre">5</span></code> containing:</p>
<ul>
<li><p><strong>Channel 0:</strong> one-hot representation of the self agent position and direction</p></li>
<li><p><strong>Channel 1:</strong> other agents’ positions and direction</p></li>
<li><p><strong>Channel 2:</strong> self and other agents’ malfunctions</p></li>
<li><p><strong>Channel 3:</strong> self and other agents’ fractional speeds</p></li>
<li><p><strong>Channel 4:</strong> number of other agents ready to depart from that position</p></li>
</ul>
</li>
<li><p><strong>Agent targets:</strong> A 3D arrays <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">×</span> <span class="pre">w</span> <span class="pre">×</span> <span class="pre">2</span></code> containing respectively the position of the current agent target, and the positions of the other agents’ targets. The positions of the targets of the other agents is a simple <code class="docutils literal notranslate"><span class="pre">0</span></code>/<code class="docutils literal notranslate"><span class="pre">1</span></code> flag, therefore this observation doesn’t indicate where each other agent is heading to.</p></li>
</ul>
<p>This observation space is well suited for single-agent navigation but does not provide enough information to solve the multi-agent navigation task, thus participants must improve on this observation space to solve the challenge.</p>
<div class="admonition-code-reference admonition">
<p class="admonition-title">Code reference</p>
<p>This observation is defined in <a class="reference external" href="https://gitlab.aicrowd.com/flatland/flatland/blob/master/flatland/envs/observations.py#L525">flatland.envs.observations.GlobalObsForRailEnv</a></p>
</div>
</div>
<div class="section" id="local-grid-observation">
<h2>Local grid observation<a class="headerlink" href="#local-grid-observation" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The local grid observation has shown limited experimental results and is considered deprecated. We keep it for historical purpose, and because it may be useful when combined with other observations. Be aware that its implementation is not currently supported.</p>
</div>
<p>The local grid observation is very similar to the global observation, where we only replace <code class="docutils literal notranslate"><span class="pre">h</span></code> and <code class="docutils literal notranslate"><span class="pre">w</span></code> by agent specific dimensions. The agent is always situated at the position <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">(w</span> <span class="pre">+</span> <span class="pre">1)/2)</span></code> within the observation grid, and the observation grid is rotated according to the agent’s direction such that the full height <code class="docutils literal notranslate"><span class="pre">h</span></code> of the observation grid is in front of the agent.</p>
<p>The initial local grid view provides the same channels as the initial global view introduced above. This observation space offers benefits over the global view, mostly by reducing the amount of irrelevant information in the observation space. Global navigation with this local observation would be impossible if no general information about the target location were given (especially when the target is outside of view). We therefore compute a distance map for every agent-target and provide this distance map as an additional channel:</p>
<ul class="simple">
<li><p><strong>Distance map:</strong> This additional channel in the local observation grid allows for a sense of direction without the need of a global view.</p></li>
</ul>
<img width="500" src="https://drive.google.com/uc?export=view&id=1kZzinMOs7hlPaSJJeIiaQ7lAz2erXuHx">
<p><em><strong>An abstract visualization of the local field of view of an agent.</strong> The green boxes represent visible cells in the agents field of view. This field of view is turned as the agent’s direction changes.</em></p>
<div class="admonition-code-reference admonition">
<p class="admonition-title">Code reference</p>
<p>This observation is defined in <a class="reference external" href="https://gitlab.aicrowd.com/flatland/flatland/blob/master/flatland/envs/observations.py#L604">flatland.envs.observations.LocalObsForRailEnv</a></p>
</div>
</div>
<div class="section" id="tree-observation">
<h2>Tree observation<a class="headerlink" href="#tree-observation" title="Permalink to this headline">¶</a></h2>
<p>The tree observation exploits the fact that a railway network is a graph and thus the observation is only built along allowed transitions in the graph. The observation is generated by spanning a 4 branched tree from the current position of the agent. Each branch follows the allowed transitions (backward branch only allowed at dead-ends) until a cell with multiple allowed transitions is reached. Here the information gathered along the branch is stored as a node in the tree.</p>
<p>Here is a small example of a railway network with an agent in the top left corner. The tree observation is build by following the allowed transitions for that agent:</p>
<p><img alt="Small_Network" src="https://i.imgur.com/utqMx08.png" /></p>
<p>As we move along the allowed transitions we build up a tree where a new node is created at every cell where the agent has different possibilities (Switch), dead-end or the target is reached.</p>
<p>It is important to note that the tree observation is always build according to the orientation of the agent at a given node. This means that each node always has 4 branches coming from it in the directions <em>Left, Forward, Right and Backward</em>. These are illustrated with different colors in the figure below. The tree is build form the example rail above. Nodes where there are no possibilities are filled with <code class="docutils literal notranslate"><span class="pre">-inf</span></code> and are not all shown here for simplicity. The tree however, always has the same number of nodes for a given tree depth.</p>
<p><img alt="Tree_Observation" src="https://i.imgur.com/VsUQOQz.png" /></p>
<p>Each node is filled with information gathered along the path to the node. Currently each node contains 12 features:</p>
<ul class="simple">
<li><p><strong>Channel 0:</strong> if own target lies on the explored branch the current distance from the agent in number of cells is stored.</p></li>
<li><p><strong>Channel 1:</strong> if another agents target is detected the distance in number of cells from current agent position is stored.</p></li>
<li><p><strong>Channel 2:</strong> if another agent is detected the distance in number of cells from current agent position is stored.</p></li>
<li><p><strong>Channel 3:</strong> possible conflict detected - this relies on a <strong>predictor</strong> that we will introduce afterward</p>
<ul>
<li><p>tot_dist = Other agent predicts to pass along this cell at the same time as the agent, we store the distance in number of cells from current agent position</p></li>
<li><p>0 = No other agent reserve the same cell at similar time</p></li>
</ul>
</li>
<li><p><strong>Channel 4:</strong> if an not usable switch (for agent) is detected we store the distance. An unusable switch is a switch where the agent does not have any choice of path (ie the agent is blocked), but other agents coming from different directions might.</p></li>
<li><p><strong>Channel 5:</strong> This feature stores the distance (in number of cells) to the next node (e.g. switch or target or dead-end)</p></li>
<li><p><strong>Channel 6:</strong> minimum remaining travel distance from node to the agent’s target given the direction of the agent if this path is chosen</p></li>
<li><p><strong>Channel 7:</strong> number of agents going in the same direction found on path to node</p></li>
<li><p><strong>Channel 8:</strong> number of agents going in the opposite direction found on path to node</p></li>
<li><p><strong>Channel 9:</strong> malfunctioning/blocking agents, returns the number of time steps the observed agent will remain blocked</p></li>
<li><p><strong>Channel 10:</strong> slowest observed speed of an agent in same direction</p>
<ul>
<li><p>1 if no agent is observed</p></li>
<li><p>min_fractional speed otherwise</p></li>
</ul>
</li>
<li><p><strong>Channel 11:</strong> number of agents ready to depart but no yet active</p></li>
</ul>
<p>Missing values are handled as follow:</p>
<ul class="simple">
<li><p>Missing/padding nodes are filled in with <code class="docutils literal notranslate"><span class="pre">-inf</span></code>.</p></li>
<li><p>Missing values in present node are filled in with <code class="docutils literal notranslate"><span class="pre">+inf</span></code>.</p></li>
</ul>
<p>Special cases:</p>
<ul class="simple">
<li><p>In case of the root node, the values are <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">distance</span> <span class="pre">from</span> <span class="pre">agent</span> <span class="pre">to</span> <span class="pre">target,</span> <span class="pre">own</span> <span class="pre">malfunction,</span> <span class="pre">own</span> <span class="pre">speed]</span></code></p></li>
<li><p>In case the target node is reached, the values are <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
</ul>
<div class="admonition-code-reference admonition">
<p class="admonition-title">Code reference</p>
<p>This observation is defined in <a class="reference external" href="https://gitlab.aicrowd.com/flatland/flatland/blob/master/flatland/envs/observations.py#L18">flatland.envs.observations.TreeObsForRailEnv</a></p>
</div>
<p>Notice how <strong>channel 4</strong> indicates if a possible conflict is detected. In order to predict conflicts, the tree observation relies on a predictor, which anticipates where agents will be in the future. We provide a stock predictor that assumes each agent just travels along its shortest path. We will <a class="reference internal" href="custom_observations.html"><span class="doc std std-doc">talk in more details about predictors</span></a> when introducing custom observations.</p>
</div>
</div>


              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Flatland Community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-132885496-4', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>